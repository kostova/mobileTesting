function HandleFileChange(){var a=(new Date).getTime();a>lastUpdate+READ_WRITE_WAIT&&setTimeout(function(){fs.readFile(SETTINGS_FILE,"utf8",function(a,b){UpdateData(b)})},READ_WRITE_WAIT),lastUpdate=a}function UpdateData(a){try{settings.data=JSON.parse(a)}catch(b){settings.data={}}settings.emit(settings.events.updated)}var fs=require("fs"),SETTINGS_FILE="./settings.json",READ_WRITE_WAIT=100,watcher,lastUpdate=0,settings;settings={events:{updated:"updated"},data:{},persist:function(){fs.writeFile(SETTINGS_FILE,JSON.stringify(settings.data,null,4),"utf8")}},settings.__proto__=process.EventEmitter.prototype,process.EventEmitter.call(settings),watch=fs.watch(SETTINGS_FILE,HandleFileChange),UpdateData(fs.readFileSync(SETTINGS_FILE,"utf8")),exports=module.exports=settings;