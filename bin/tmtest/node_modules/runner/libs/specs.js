function FireSpecsUpdated(a){specs.emit(specs.events.updated,dirName,a)}function PropagateDirSpecs(){fs.readdir(dirName,function(a,b){for(var c=[],d=0;d<b.length;d++)-1!==b[d].search(/.js$/)&&c.push(b[d]);FireSpecsUpdated(c)})}function HandleDirectoryChange(){clearTimeout(updateTimeout),updateTimeout=setTimeout(PropagateDirSpecs,500)}var fs=require("fs"),path=require("path"),dirName="",watcher=null,updateTimeout=null,specs;specs={events:{updated:"updated"},updateSpecFolder:function(a){var b=a?a:"";0===b.indexOf("./")&&(b=path.join(process.cwd(),b)),b=path.join(b,"/"),dirName!==b&&(dirName=b,watcher&&(watcher.close(),watcher=null),fs.existsSync(dirName)&&(watcher=fs.watch(dirName,HandleDirectoryChange)),specs.requestSpecs())},requestSpecs:function(){watcher?PropagateDirSpecs():FireSpecsUpdated([])}},specs.__proto__=process.EventEmitter.prototype,process.EventEmitter.call(specs),exports=module.exports=specs;