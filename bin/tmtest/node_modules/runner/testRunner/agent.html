<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
	<link href="assets/tap-style.css" rel="stylesheet">
	<link href="assets/font-awesome.min.css" rel="stylesheet">
	<script type='text/javascript' src="agent/TelerikTestingWebAgent.js"></script>
	<style>
		*{ margin: 0; padding: 0; border: 0; font-family: "Open Sans", sans-serif; box-sizing: border-box; }
		p { font-size: 18px; }
		img { margin: 50px 0; }
		.message { position: relative; display: none; margin: auto; text-align: center; }
		/* override TAP style that causes ios safari to make all content invisible */
		html:before, html:after, body:before, body:after { content: normal; }

		#breadcrumb li:first-child a { background-image: url("assets/logo.png") !important; cursor: default; }

		@font-face {
		    font-family: 'Open Sans';
		    src: url('assets/font/OpenSans-Regular-webfont.eot');
		    src: url('assets/font/OpenSans-Regular-webfont.eot?#iefix') format('embedded-opentype'),
		         url('assets/font/OpenSans-Regular-webfont.woff') format('woff'),
		         url('assets/font/OpenSans-Regular-webfont.ttf') format('truetype'),
		         url('assets/font/OpenSans-Regular-webfont.svg#open_sansregular') format('svg');
		    font-weight: normal;
		    font-style: normal;
		}
		@font-face {
		    font-family: 'Open Sans';
		    src: url('assets/font/OpenSans-Bold-webfont.eot');
		    src: url('assets/font/OpenSans-Bold-webfont.eot?#iefix') format('embedded-opentype'),
		         url('assets/font/OpenSans-Bold-webfont.woff') format('woff'),
		         url('assets/font/OpenSans-Bold-webfont.ttf') format('truetype'),
		         url('assets/font/OpenSans-Bold-webfont.svg#open_sansbold') format('svg');
		    font-weight: bold;
		    font-style: normal;
		}
	</style>
</head>
<body>

	<div class="tap-header" style="position: static;">
		<div class="main-navigation">
			<ul id="breadcrumb">
				<li><a><span style="font-weight: bold;">Telerik</span><span style="font-weight: normal; color: #3496da;">&nbsp;Mobile Testing</span></a></li>
			</ul>
		</div>

		<ul class="global-nav">
			<li class="global global-help">
				<a href="http://docs.telerik.com/platform/mobile-testing/overview" target="_blank">
					<i class="icon-question-sign"></i>
					<span>Help</span>
				</a>
			</li>
		</ul>
	</div>

	<div id="connecting" class="message">
		<img src="assets/loading-big.gif">
		<p>Connecting to Telerik Testing.</p>
	</div>
	
	<div id="connected" class="message">
		<img src="assets/connected.png">
		<p>Connected and ready to run tests.</p>
	</div>
	
	<div id="disconnected" class="message">
		<img src="assets/disconnected.png">
		<p>Not connected. Please refresh the page.</p>
	</div>

<script>

	var params = parseQueryString(location.search),
		messageServerUrl = decodeURIComponent(params.messageServerUrl || ""),
		timeout = parseInt(params.timeout),
		sharedKey = params.sharedKey || '5e2e79fa-a3b3-9b65-a9ee-dafa1d83fc68';

	function hideMessageDivs(){
		var messages = document.querySelectorAll(".message");
		for(var i=0; i<messages.length; i++){
			messages[i].style.display = "none";
		}
	}

	function parseQueryString(queryString){
		var paramMap = {},
			queryStringArr;

		if(queryString[0] === "?") queryString = queryString.substr(1);

		queryStringArr = queryString.split("&");
		for(var i = 0; i < queryStringArr.length; i++){
			var items = queryStringArr[i].split("=");
			paramMap[items[0]] = items[1];
		};

		return paramMap;
	}

	function displayError(msg){
		document.getElementById("disconnected").style.display = "block";
		document.getElementById("disconnected").querySelector("p").innerHTML = "Not Connected.<br> "+ msg;
	}

	if(telerik_testing_js_agent.error){
		// something went wrong during construction
		// of the agent object
		displayError(telerik_testing_js_agent.error);		

	} else {
		telerik_testing_js_agent.onConnect = function(){
			hideMessageDivs();
			document.getElementById("connected").style.display = "block";
		};
		telerik_testing_js_agent.onDisconnect = function(){
			hideMessageDivs();
			document.getElementById("disconnected").style.display = "block";
		};
		telerik_testing_js_agent.onError = function(e){
			hideMessageDivs();
			displayError(e);
		};

		document.getElementById("connecting").style.display = "block";

		telerik_testing_js_agent.onInitialized = function() {
			telerik_testing_js_agent.start(messageServerUrl, sharedKey, timeout);
		}
	}	

</script>
</body>
</html>